<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>WhatsApp Parser â€” Exportar para Excel</title>
  <meta name="description" content="Parse WhatsApp exported conversations and generate formatted Excel files with multiple tabs. 100% browser-based, no backend needed." />

  <!-- Google Fonts: Inter -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet" />

  <!-- Tailwind CSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            'wp-bg': '#0F1923',
            'wp-card': '#1A2535',
            'wp-green': '#25D366',
            'wp-green-dark': '#075E54',
            'wp-green-mid': '#128C7E',
            'wp-text': '#FFFFFF',
            'wp-text-sec': '#8A9BB0',
            'wp-error': '#FF5C5C',
            'wp-excel': '#1D6F42',
          },
          fontFamily: {
            inter: ['Inter', 'Segoe UI', 'sans-serif'],
          },
        },
      },
    };
  </script>

  <!-- React 18 + ReactDOM via CDN -->
  <script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>

  <!-- Babel standalone for JSX -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <!-- SheetJS (xlsx) -->
  <script src="https://cdn.sheetjs.com/xlsx-0.20.3/package/dist/xlsx.full.min.js"></script>

  <style>
    *, *::before, *::after { box-sizing: border-box; }
    body {
      margin: 0;
      padding: 0;
      background: #0F1923;
      font-family: 'Inter', 'Segoe UI', sans-serif;
      color: #FFFFFF;
      min-height: 100vh;
      overflow-x: hidden;
    }

    /* Animated dashed border */
    @keyframes borderDash {
      0% { background-position: 0 0, 100% 0, 100% 100%, 0 100%; }
      100% { background-position: 100% 0, 100% 100%, 0 100%, 0 0; }
    }

    .drop-zone-border {
      background-image:
        linear-gradient(90deg, #25D366 50%, transparent 50%),
        linear-gradient(0deg, #25D366 50%, transparent 50%),
        linear-gradient(90deg, #25D366 50%, transparent 50%),
        linear-gradient(0deg, #25D366 50%, transparent 50%);
      background-size:
        20px 2px, 2px 20px, 20px 2px, 2px 20px;
      background-position:
        0 0, 100% 0, 100% 100%, 0 100%;
      background-repeat: no-repeat;
      animation: borderDash 8s linear infinite;
      padding: 2px;
      border-radius: 14px;
    }

    .drop-zone-border.dragging {
      animation: borderDash 1s linear infinite;
      background-image:
        linear-gradient(90deg, #25D366 70%, transparent 30%),
        linear-gradient(0deg, #25D366 70%, transparent 30%),
        linear-gradient(90deg, #25D366 70%, transparent 30%),
        linear-gradient(0deg, #25D366 70%, transparent 30%);
    }

    /* Shimmer progress */
    @keyframes shimmer {
      0% { transform: translateX(-100%); }
      100% { transform: translateX(100%); }
    }
    .shimmer-bar::after {
      content: '';
      position: absolute;
      top: 0; left: 0; right: 0; bottom: 0;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.25), transparent);
      animation: shimmer 1.5s infinite;
    }

    /* Fade-slide-up animation */
    @keyframes fadeSlideUp {
      0% { opacity: 0; transform: translateY(30px); }
      100% { opacity: 1; transform: translateY(0); }
    }
    .animate-fade-slide-up {
      animation: fadeSlideUp 0.6s ease-out forwards;
    }

    /* Subtle pulse for download button */
    @keyframes subtlePulse {
      0%, 100% { box-shadow: 0 0 0 0 rgba(37, 211, 102, 0.4); }
      50% { box-shadow: 0 0 0 12px rgba(37, 211, 102, 0); }
    }
    .pulse-green {
      animation: subtlePulse 2.5s infinite;
    }

    /* Toast animation */
    @keyframes toastIn {
      0% { transform: translateX(120%); opacity: 0; }
      100% { transform: translateX(0); opacity: 1; }
    }
    @keyframes toastOut {
      0% { transform: translateX(0); opacity: 1; }
      100% { transform: translateX(120%); opacity: 0; }
    }
    .toast-in { animation: toastIn 0.4s ease-out forwards; }
    .toast-out { animation: toastOut 0.4s ease-in forwards; }

    /* Scrollbar */
    ::-webkit-scrollbar { width: 6px; }
    ::-webkit-scrollbar-track { background: #0F1923; }
    ::-webkit-scrollbar-thumb { background: #25D366; border-radius: 3px; }

    /* Glassmorphism card */
    .glass-card {
      background: rgba(26, 37, 53, 0.7);
      backdrop-filter: blur(16px);
      -webkit-backdrop-filter: blur(16px);
      border: 1px solid rgba(37, 211, 102, 0.12);
    }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useCallback, useRef, useEffect } = React;

    /* â”€â”€â”€â”€â”€ CHIP COLORS â”€â”€â”€â”€â”€ */
    const CHIP_COLORS = [
      { bg: '#25D366', text: '#000' },
      { bg: '#3B82F6', text: '#FFF' },
      { bg: '#F59E0B', text: '#000' },
      { bg: '#8B5CF6', text: '#FFF' },
      { bg: '#F97316', text: '#000' },
    ];

    /* â”€â”€â”€â”€â”€ ROW COLORS FOR EXCEL â”€â”€â”€â”€â”€ */
    const ROW_COLORS = ['D4EDDA', 'CCE5FF', 'FFF3CD', 'E8DAEF', 'FFE0CC', 'D5F5E3', 'D6EAF8', 'FDEBD0'];

    /* â”€â”€â”€â”€â”€ TOAST COMPONENT â”€â”€â”€â”€â”€ */
    function Toast({ message, visible, onHide }) {
      const [leaving, setLeaving] = useState(false);

      useEffect(() => {
        if (visible) {
          setLeaving(false);
          const timer = setTimeout(() => {
            setLeaving(true);
            setTimeout(onHide, 400);
          }, 3000);
          return () => clearTimeout(timer);
        }
      }, [visible, onHide]);

      if (!visible && !leaving) return null;

      return (
        <div className={`fixed bottom-6 right-6 z-50 flex items-center gap-3 px-5 py-3 rounded-xl shadow-2xl ${leaving ? 'toast-out' : 'toast-in'}`}
             style={{ background: 'linear-gradient(135deg, #1D6F42, #25D366)' }}>
          <span className="text-xl">âœ…</span>
          <span className="text-white font-semibold text-sm">{message}</span>
        </div>
      );
    }

    /* â”€â”€â”€â”€â”€ WHATSAPP PARSER â”€â”€â”€â”€â”€ */
    function parseWhatsApp(text) {
      const lines = text.split('\n');
      const regex = /(\d{1,2}\/\d{1,2}\/\d{2,4}),?\s(\d{1,2}:\d{2})(?:\s?[APap][Mm])?\s?-\s([^:]+):\s(.+)/;
      const messages = [];

      for (let i = 0; i < lines.length; i++) {
        const match = lines[i].match(regex);
        if (match) {
          messages.push({
            data: match[1],
            hora: match[2],
            autor: match[3].trim(),
            mensagem: match[4],
          });
        } else if (messages.length > 0 && lines[i].trim() !== '') {
          messages[messages.length - 1].mensagem += '\n' + lines[i];
        }
      }
      return messages;
    }

    /* â”€â”€â”€â”€â”€ STATS BUILDER â”€â”€â”€â”€â”€ */
    function buildStats(messages) {
      const authors = {};
      const perDay = {};

      messages.forEach((m) => {
        if (!authors[m.autor]) {
          authors[m.autor] = { count: 0, first: m.data + ' ' + m.hora, last: m.data + ' ' + m.hora };
        }
        authors[m.autor].count++;
        authors[m.autor].last = m.data + ' ' + m.hora;

        perDay[m.data] = (perDay[m.data] || 0) + 1;
      });

      const participants = Object.keys(authors);
      const firstDate = messages.length > 0 ? messages[0].data : '';
      const lastDate = messages.length > 0 ? messages[messages.length - 1].data : '';

      return { total: messages.length, participants, authors, perDay, firstDate, lastDate };
    }

    /* â”€â”€â”€â”€â”€ EXCEL GENERATOR â”€â”€â”€â”€â”€ */
    function generateExcel(messages, stats) {
      const wb = XLSX.utils.book_new();
      const authorColorMap = {};
      stats.participants.forEach((p, i) => {
        authorColorMap[p] = ROW_COLORS[i % ROW_COLORS.length];
      });

      /* --- Aba 1: Conversa --- */
      const wsConvData = [['#', 'Data', 'Hora', 'Participante', 'Mensagem']];
      messages.forEach((m, i) => {
        wsConvData.push([i + 1, m.data, m.hora, m.autor, m.mensagem]);
      });
      const wsConv = XLSX.utils.aoa_to_sheet(wsConvData);
      wsConv['!cols'] = [
        { wch: 6 },
        { wch: 12 },
        { wch: 8 },
        { wch: 22 },
        { wch: 60 },
      ];
      XLSX.utils.book_append_sheet(wb, wsConv, 'Conversa');

      /* --- Aba 2: Resumo --- */
      const wsResumoData = [
        ['RESUMO DA CONVERSA'],
        [],
        ['Total de Mensagens', stats.total],
        ['Participantes', stats.participants.length],
        ['Data Inicial', stats.firstDate],
        ['Data Final', stats.lastDate],
        [],
        ['Participante', 'Mensagens', '% do Total', 'Primeira Msg', 'Ãšltima Msg'],
      ];
      let totalMsgs = 0;
      stats.participants.forEach((p) => {
        const a = stats.authors[p];
        const pct = ((a.count / stats.total) * 100).toFixed(1) + '%';
        wsResumoData.push([p, a.count, pct, a.first, a.last]);
        totalMsgs += a.count;
      });
      wsResumoData.push(['TOTAL', totalMsgs, '100%', '', '']);
      const wsResumo = XLSX.utils.aoa_to_sheet(wsResumoData);
      wsResumo['!cols'] = [
        { wch: 24 },
        { wch: 12 },
        { wch: 12 },
        { wch: 20 },
        { wch: 20 },
      ];
      XLSX.utils.book_append_sheet(wb, wsResumo, 'Resumo');

      /* --- Aba 3: Por Dia --- */
      const wsDayData = [['Data', 'Total de Mensagens']];
      let dayTotal = 0;
      Object.keys(stats.perDay).forEach((day) => {
        wsDayData.push([day, stats.perDay[day]]);
        dayTotal += stats.perDay[day];
      });
      wsDayData.push(['TOTAL', dayTotal]);
      const wsDay = XLSX.utils.aoa_to_sheet(wsDayData);
      wsDay['!cols'] = [
        { wch: 14 },
        { wch: 20 },
      ];
      XLSX.utils.book_append_sheet(wb, wsDay, 'Por Dia');

      return wb;
    }

    /* â”€â”€â”€â”€â”€ MAIN APP â”€â”€â”€â”€â”€ */
    function App() {
      const [appState, setAppState] = useState('initial'); // initial | selected | processing | done | error
      const [file, setFile] = useState(null);
      const [messages, setMessages] = useState([]);
      const [stats, setStats] = useState(null);
      const [workbook, setWorkbook] = useState(null);
      const [errorMsg, setErrorMsg] = useState('');
      const [progress, setProgress] = useState(0);
      const [dragging, setDragging] = useState(false);
      const [toastVisible, setToastVisible] = useState(false);

      const fileInputRef = useRef(null);
      const dropRef = useRef(null);

      /* Drag & Drop handlers */
      const handleDragOver = useCallback((e) => {
        e.preventDefault();
        e.stopPropagation();
        setDragging(true);
      }, []);

      const handleDragLeave = useCallback((e) => {
        e.preventDefault();
        e.stopPropagation();
        setDragging(false);
      }, []);

      const handleDrop = useCallback((e) => {
        e.preventDefault();
        e.stopPropagation();
        setDragging(false);
        const droppedFile = e.dataTransfer.files[0];
        if (droppedFile && droppedFile.name.endsWith('.txt')) {
          setFile(droppedFile);
          setAppState('selected');
          setErrorMsg('');
        } else {
          setErrorMsg('Por favor, selecione um arquivo .txt exportado do WhatsApp.');
          setAppState('error');
        }
      }, []);

      const handleFileSelect = useCallback((e) => {
        const selectedFile = e.target.files[0];
        if (selectedFile && selectedFile.name.endsWith('.txt')) {
          setFile(selectedFile);
          setAppState('selected');
          setErrorMsg('');
        } else if (selectedFile) {
          setErrorMsg('Por favor, selecione um arquivo .txt exportado do WhatsApp.');
          setAppState('error');
        }
      }, []);

      const handleClickDropZone = useCallback(() => {
        fileInputRef.current?.click();
      }, []);

      /* Process file */
      const handleProcess = useCallback(() => {
        if (!file) return;
        setAppState('processing');
        setProgress(0);

        const reader = new FileReader();
        reader.onload = (e) => {
          try {
            // Simulate progress for UX
            let p = 0;
            const interval = setInterval(() => {
              p += Math.random() * 15 + 5;
              if (p >= 90) {
                clearInterval(interval);
                setProgress(90);
              } else {
                setProgress(Math.round(p));
              }
            }, 100);

            const text = e.target.result;
            const parsed = parseWhatsApp(text);

            if (parsed.length === 0) {
              clearInterval(interval);
              setErrorMsg('Nenhuma mensagem encontrada. Verifique se o arquivo Ã© uma exportaÃ§Ã£o vÃ¡lida do WhatsApp.');
              setAppState('error');
              return;
            }

            const s = buildStats(parsed);
            const wb = generateExcel(parsed, s);

            setTimeout(() => {
              clearInterval(interval);
              setProgress(100);
              setMessages(parsed);
              setStats(s);
              setWorkbook(wb);
              setTimeout(() => setAppState('done'), 400);
            }, 800);
          } catch (err) {
            setErrorMsg('Erro ao processar o arquivo: ' + err.message);
            setAppState('error');
          }
        };
        reader.onerror = () => {
          setErrorMsg('Erro ao ler o arquivo.');
          setAppState('error');
        };
        reader.readAsText(file, 'UTF-8');
      }, [file]);

      /* Download Excel */
      const handleDownload = useCallback(() => {
        if (!workbook) return;
        XLSX.writeFile(workbook, `WhatsApp_Conversa_${stats.firstDate.replace(/\//g, '-')}_a_${stats.lastDate.replace(/\//g, '-')}.xlsx`);
        setToastVisible(true);
      }, [workbook, stats]);

      /* Reset */
      const handleReset = useCallback(() => {
        setAppState('initial');
        setFile(null);
        setMessages([]);
        setStats(null);
        setWorkbook(null);
        setErrorMsg('');
        setProgress(0);
        if (fileInputRef.current) fileInputRef.current.value = '';
      }, []);

      return (
        <div className="min-h-screen flex flex-col font-inter">
          {/* â”€â”€ HEADER â”€â”€ */}
          <header className="w-full px-4 sm:px-6 py-4 flex items-center justify-between border-b border-white/5"
                  style={{ background: 'linear-gradient(135deg, #0F1923 0%, #1A2535 100%)' }}>
            <div className="flex items-center gap-3">
              <span className="text-3xl">ğŸ’¬</span>
              <div>
                <h1 className="text-xl sm:text-2xl font-bold text-white tracking-tight">WhatsApp Parser</h1>
              </div>
            </div>
            <div className="flex items-center gap-2 bg-wp-green-dark/40 rounded-full px-3 py-1.5">
              <span className="text-xs font-semibold text-wp-green">v3.0</span>
              <span className="text-xs text-wp-text-sec">Excel</span>
            </div>
          </header>

          {/* â”€â”€ MAIN CONTENT â”€â”€ */}
          <main className="flex-1 flex flex-col items-center justify-start px-4 py-8 sm:py-12 max-w-2xl mx-auto w-full">

            {/* â”€â”€ DROP ZONE â”€â”€ */}
            {(appState === 'initial' || appState === 'selected' || appState === 'error') && (
              <div className={`drop-zone-border w-full mb-6 transition-all duration-300 ${dragging ? 'dragging' : ''}`}>
                <div
                  ref={dropRef}
                  onClick={handleClickDropZone}
                  onDragOver={handleDragOver}
                  onDragLeave={handleDragLeave}
                  onDrop={handleDrop}
                  className={`w-full rounded-xl cursor-pointer transition-all duration-300 flex flex-col items-center justify-center py-12 sm:py-16 gap-3 ${
                    dragging
                      ? 'bg-wp-green/10'
                      : appState === 'selected'
                      ? 'bg-wp-card'
                      : 'bg-wp-card hover:bg-wp-card/80'
                  }`}
                  id="drop-zone"
                >
                  <input
                    type="file"
                    ref={fileInputRef}
                    accept=".txt"
                    className="hidden"
                    onChange={handleFileSelect}
                    id="file-input"
                  />

                  {appState === 'selected' && file ? (
                    <>
                      <span className="text-4xl">âœ…</span>
                      <p className="text-white font-semibold text-lg">{file.name}</p>
                      <p className="text-wp-text-sec text-sm">
                        {(file.size / 1024).toFixed(1)} KB Â· Pronto para processar
                      </p>
                    </>
                  ) : (
                    <>
                      <span className="text-4xl">ğŸ“</span>
                      <p className="text-white font-semibold text-lg text-center">
                        Arraste o <span className="text-wp-green">.txt</span> aqui ou clique para selecionar
                      </p>
                      <p className="text-wp-text-sec text-sm">Arquivo exportado do WhatsApp</p>
                    </>
                  )}
                </div>
              </div>
            )}

            {/* â”€â”€ ERROR STATE â”€â”€ */}
            {appState === 'error' && errorMsg && (
              <div className="w-full mb-6 rounded-xl p-4 flex items-start gap-3 animate-fade-slide-up"
                   style={{ background: 'rgba(255, 92, 92, 0.12)', border: '1px solid rgba(255, 92, 92, 0.3)' }}>
                <span className="text-xl mt-0.5">âš ï¸</span>
                <div className="flex-1">
                  <p className="text-wp-error font-semibold text-sm">{errorMsg}</p>
                  <button
                    onClick={handleReset}
                    className="mt-2 text-xs text-wp-text-sec underline hover:text-white transition-colors"
                  >
                    Tentar novamente
                  </button>
                </div>
              </div>
            )}

            {/* â”€â”€ HINT + BADGE (initial state) â”€â”€ */}
            {(appState === 'initial' || appState === 'selected' || appState === 'error') && (
              <>
                <div className="w-full flex items-start gap-2 mb-4 px-1">
                  <span className="text-base mt-0.5">â„¹ï¸</span>
                  <p className="text-wp-text-sec text-xs sm:text-sm leading-relaxed">
                    WhatsApp â†’ <span className="text-white font-medium">â‹®</span> â†’ Mais â†’
                    <span className="text-white font-medium"> Exportar conversa</span> â†’
                    <span className="text-white font-medium"> Sem mÃ­dia</span>
                  </p>
                </div>

                <div className="flex items-center gap-2 bg-wp-excel/20 border border-wp-excel/30 rounded-full px-4 py-2 mb-6">
                  <span className="text-lg">ğŸ“—</span>
                  <span className="text-sm font-medium text-green-300">
                    Exporta para Excel com 3 abas
                  </span>
                </div>
              </>
            )}

            {/* â”€â”€ PROCESS BUTTON (selected state) â”€â”€ */}
            {appState === 'selected' && (
              <button
                onClick={handleProcess}
                className="w-full sm:w-auto px-10 py-3.5 rounded-full font-bold text-base text-white transition-all duration-300 hover:scale-105 active:scale-95 mb-6"
                style={{ background: 'linear-gradient(135deg, #25D366, #128C7E)' }}
                id="process-btn"
              >
                ğŸš€ Processar Conversa
              </button>
            )}

            {/* â”€â”€ PROGRESS BAR â”€â”€ */}
            {appState === 'processing' && (
              <div className="w-full mb-6 animate-fade-slide-up">
                <div className="flex items-center justify-between mb-2">
                  <p className="text-wp-text-sec text-sm font-medium">Analisando conversa...</p>
                  <p className="text-wp-green text-sm font-bold">{progress}%</p>
                </div>
                <div className="w-full h-3 rounded-full overflow-hidden" style={{ background: '#1A2535' }}>
                  <div
                    className="h-full rounded-full relative shimmer-bar transition-all duration-200"
                    style={{
                      width: `${progress}%`,
                      background: 'linear-gradient(90deg, #075E54, #25D366)',
                    }}
                  />
                </div>
              </div>
            )}

            {/* â”€â”€ RESULT CARD â”€â”€ */}
            {appState === 'done' && stats && (
              <div className="w-full animate-fade-slide-up">
                <div className="glass-card rounded-2xl p-6 sm:p-8 mb-6 shadow-2xl">
                  <h2 className="text-lg font-bold text-white mb-5 flex items-center gap-2">
                    <span>ğŸ“Š</span> Resultado da AnÃ¡lise
                  </h2>

                  <div className="grid grid-cols-1 sm:grid-cols-3 gap-4 mb-6">
                    {/* Messages */}
                    <div className="bg-white/5 rounded-xl p-4 text-center border border-white/5">
                      <p className="text-3xl font-extrabold text-wp-green">
                        {stats.total.toLocaleString('pt-BR')}
                      </p>
                      <p className="text-wp-text-sec text-xs mt-1 font-medium">mensagens</p>
                    </div>
                    {/* Participants */}
                    <div className="bg-white/5 rounded-xl p-4 text-center border border-white/5">
                      <p className="text-3xl font-extrabold text-blue-400">
                        {stats.participants.length}
                      </p>
                      <p className="text-wp-text-sec text-xs mt-1 font-medium">participantes</p>
                    </div>
                    {/* Period */}
                    <div className="bg-white/5 rounded-xl p-4 text-center border border-white/5">
                      <p className="text-sm font-bold text-yellow-300">
                        ğŸ“… {stats.firstDate}
                      </p>
                      <p className="text-wp-text-sec text-xs my-1">â†’</p>
                      <p className="text-sm font-bold text-yellow-300">
                        {stats.lastDate}
                      </p>
                    </div>
                  </div>

                  {/* Participant Chips */}
                  <div className="mb-2">
                    <p className="text-wp-text-sec text-xs font-semibold uppercase tracking-wider mb-3">
                      ğŸ‘¥ Participantes
                    </p>
                    <div className="flex flex-wrap gap-2">
                      {stats.participants.map((p, i) => {
                        const color = CHIP_COLORS[i % CHIP_COLORS.length];
                        const count = stats.authors[p].count;
                        return (
                          <div
                            key={p}
                            className="flex items-center gap-2 rounded-full px-3 py-1.5 text-xs font-semibold transition-transform hover:scale-105"
                            style={{ background: color.bg + '22', border: `1px solid ${color.bg}66`, color: color.bg }}
                          >
                            <span
                              className="w-2 h-2 rounded-full"
                              style={{ background: color.bg }}
                            />
                            <span>{p}</span>
                            <span className="opacity-60">({count})</span>
                          </div>
                        );
                      })}
                    </div>
                  </div>

                  {/* Top senders */}
                  <div className="mt-5 border-t border-white/5 pt-5">
                    <p className="text-wp-text-sec text-xs font-semibold uppercase tracking-wider mb-3">
                      ğŸ† Ranking
                    </p>
                    <div className="space-y-2">
                      {stats.participants
                        .sort((a, b) => stats.authors[b].count - stats.authors[a].count)
                        .slice(0, 5)
                        .map((p, i) => {
                          const count = stats.authors[p].count;
                          const pct = ((count / stats.total) * 100).toFixed(1);
                          const color = CHIP_COLORS[i % CHIP_COLORS.length];
                          return (
                            <div key={p} className="flex items-center gap-3">
                              <span className="text-xs text-wp-text-sec w-5 text-right">{i + 1}.</span>
                              <div className="flex-1">
                                <div className="flex items-center justify-between mb-1">
                                  <span className="text-xs font-medium text-white truncate max-w-[180px]">{p}</span>
                                  <span className="text-xs text-wp-text-sec">{count} ({pct}%)</span>
                                </div>
                                <div className="w-full h-1.5 rounded-full bg-white/5">
                                  <div
                                    className="h-full rounded-full transition-all duration-500"
                                    style={{ width: `${pct}%`, background: color.bg }}
                                  />
                                </div>
                              </div>
                            </div>
                          );
                        })}
                    </div>
                  </div>
                </div>

                {/* â”€â”€ DOWNLOAD BUTTON â”€â”€ */}
                <div className="flex flex-col sm:flex-row items-center gap-3 justify-center">
                  <button
                    onClick={handleDownload}
                    className="pulse-green px-10 py-4 rounded-full font-bold text-lg text-white transition-all duration-300 hover:scale-105 active:scale-95 flex items-center gap-2"
                    style={{ background: 'linear-gradient(135deg, #25D366, #1D6F42)' }}
                    id="download-btn"
                  >
                    <span>â¬‡ï¸</span> Baixar Excel Formatado
                  </button>
                  <button
                    onClick={handleReset}
                    className="text-wp-text-sec text-sm hover:text-white transition-colors underline"
                    id="reset-btn"
                  >
                    Processar outro arquivo
                  </button>
                </div>
              </div>
            )}
          </main>

          {/* â”€â”€ FOOTER â”€â”€ */}
          <footer className="w-full px-4 py-4 text-center border-t border-white/5">
            <p className="text-wp-text-sec text-xs">
              100% no browser Â· Sem upload Â· Seus dados ficam no seu dispositivo ğŸ”’
            </p>
          </footer>

          {/* â”€â”€ TOAST â”€â”€ */}
          <Toast
            message="Excel baixado com sucesso!"
            visible={toastVisible}
            onHide={() => setToastVisible(false)}
          />
        </div>
      );
    }

    /* â”€â”€ RENDER â”€â”€ */
    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<App />);
  </script>
</body>
</html>
